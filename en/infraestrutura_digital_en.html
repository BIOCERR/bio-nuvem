<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Digital Infrastructure ‚Äî BIOCERR</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    /* --- Base styles (kept the original visual) --- */
    body {
      margin: 0;
      padding: 40px;
      background: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
      color: white;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
    }

    .top-bar {
      position: absolute;
      top: 20px;
      left: 20px;
      z-index: 10;
    }

    .top-bar a {
      text-decoration: none;
      color: #74f2ce;
      font-weight: bold;
      font-size: 1em;
      border: 1px solid #74f2ce;
      padding: 8px 15px;
      border-radius: 20px;
      transition: all 0.3s ease;
      background: rgba(0,0,0,0.35);
    }

    .top-bar a:hover {
      background: rgba(116, 242, 206, 0.12);
      box-shadow: 0 0 10px #74f2ce;
    }

    h1 {
      text-align: center;
      font-size: 3em;
      text-shadow: 0 0 15px #74f2ce, 0 0 25px #74f2ce;
      filter: drop-shadow(0 0 5px #2de0c1);
      margin-bottom: 40px;
    }

    .content {
      max-width: 1000px;
      margin: 0 auto;
      font-size: 1.15em;
      text-align: justify;
    }

    .image-container {
      text-align: center;
      margin: 40px 0;
    }

    .image-container img {
      width: 35%;
      max-width: 420px;
      border: 2px solid #74f2ce;
      border-radius: 10px;
      box-shadow: 0 0 15px #2de0c1;
    }

    .mist {
      position: fixed;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle, rgba(116, 242, 206, 0.05) 0%, transparent 70%);
      filter: blur(25px);
      pointer-events: none;
      z-index: -1;
    }

    .tech-modules {
      margin: 60px auto;
      max-width: 900px;
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
    }

    .tech-card {
      background-color: rgba(116, 242, 206, 0.08);
      border: 1px solid #74f2ce;
      border-radius: 12px;
      padding: 20px 30px;
      cursor: pointer;
      font-size: 1.05em;
      color: #74f2ce;
      text-align: center;
      box-shadow: 0 0 12px rgba(45, 224, 193, 0.12);
      transition: all 0.25s ease;
      min-width: 220px;
    }

    .tech-card:hover {
      background-color: rgba(116, 242, 206, 0.16);
      box-shadow: 0 0 18px #2de0c1;
    }

    .box-hidden {
      display: none;
      margin-top: 10px;
      margin-bottom: 40px;
      background-color: rgba(255,255,255,0.04);
      padding: 20px;
      border-radius: 10px;
      border-left: 3px solid #74f2ce;
      color: #ddd;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
      text-align: justify;
    }

    .box-hidden p, .box-hidden ul { color: #e6f7f1; }

    .link-pdf {
      color: #74f2ce;
      font-weight: bold;
      text-decoration: none;
      display: inline-block;
      margin-top: 10px;
    }

    .link-pdf:hover { text-decoration: underline; }

    /* --- Graph styles (vis-network) --- */
    .graph-wrapper {
      max-width: 1000px;
      margin: 24px auto 10px auto;
      padding: 14px;
      border-radius: 12px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(116,242,206,0.06);
      box-shadow: 0 6px 20px rgba(0,0,0,0.6);
    }

    #network, #networkGaia, #networkBlockchain, #networkBigData, #networkIoT {
      width: 100%;
      height: 390px;
      background: transparent;
      border-radius: 8px;
    }

    .graph-instructions {
      margin-top: 10px;
      font-size: 0.95em;
      line-height: 1.5;
      color: #cfeee6;
      background: rgba(255,255,255,0.03);
      border: 1px dashed rgba(116,242,206,0.35);
      border-radius: 8px;
      padding: 10px 12px;
    }

    #nodeDetails, #nodeDetailsGaia, #nodeDetailsBlockchain, #nodeDetailsBigData, #nodeDetailsIoT {
      display: none;
      max-width: 900px;
      margin: 14px auto 40px;
      background: rgba(255,255,255,0.03);
      border-left: 3px solid #74f2ce;
      color: #e7f9f2;
      padding: 18px;
      border-radius: 8px;
      text-align: left;
    }

    #nodeDetails h3, #nodeDetailsGaia h3, #nodeDetailsBlockchain h3, #nodeDetailsBigData h3, #nodeDetailsIoT h3 { margin-top: 0; color: #74f2ce; }
    .close-btn {
      display: inline-block;
      margin-top: 10px;
      background: transparent;
      color: #74f2ce;
      border: 1px solid rgba(116,242,206,0.2);
      padding: 6px 10px;
      border-radius: 8px;
      cursor: pointer;
    }

    @media (max-width: 600px) {
      h1 { font-size: 2em; padding-top: 10px; }
      .tech-card { min-width: 100%; }
      #network, #networkGaia, #networkBlockchain, #networkBigData, #networkIoT { height: 320px; }
    }
  </style>

  <!-- vis-network -->
  <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
</head>
<body>

  <div class="top-bar">
    <a href="cloud_bio.html">‚¨ÖÔ∏è Back to BIO Cloud</a>
  </div>

  <h1>Digital Infrastructure</h1>

  <div class="content">
    <p>
      The <strong>Digital Infrastructure</strong> of BIOCERR is the invisible backbone that connects data, processes and territories in an integrated, regenerative way. It goes beyond technology alone ‚Äî it‚Äôs an ecosystem of technical, ethical and territorial support that enables the BIO network to operate with transparency, intelligence and shared responsibility.
    </p>

    <p>
      Instead of centralized platforms, we use distributed, interoperable and open-source architectures. This guarantees local autonomy, data sovereignty and active participation of the involved communities. Each node in the network contributes and benefits, strengthening collective resilience.
    </p>

    <p>
      The infrastructure includes traceability modules, regenerative indicator management, real-time monitoring and integration with public and community systems. Everything is designed to be modular, adaptable and constantly evolving.
    </p>

    <p>
      The artificial intelligence <strong>BIO</strong> acts as mediator of these digital interactions, translating complexity into clarity, suggesting paths, alerting about imbalances and supporting informed decisions based on the principles of regeneration.
    </p>

    <p>
      Investing in digital infrastructure is to ensure that regeneration happens consistently, with monitoring and alignment between people, territories and technologies. It is the foundation for a new cycle of planetary care.
    </p>

    <div class="image-container">
      <img src="infraestrutura_digital_en.png" alt="Digital infrastructure illustration">
    </div>
  </div>

  <div class="tech-modules">
    <div class="tech-card" onclick="toggleBox('blockchain')">üß± Blockchain</div>
    <div id="blockchain" class="box-hidden">
      <p><strong>BIOBlock:</strong> Blockchain is a distributed ledger technology that functions as an immutable and transparent digital ledger. Instead of relying on a single central authority, information is stored on a decentralized network of computers (nodes). Each validated transaction or piece of data is grouped into a block, which contains a unique identifier (hash) and the cryptographic reference to the previous block, forming a tamper-proof chain.</p>

     <p>Its main advantage lies in its security and reliability, as any attempted alteration is immediately detected by all network participants. Furthermore, Blockchain ensures transparency, traceability, and trust in digital processes, eliminating intermediaries and reducing costs.</p>

     <p>In BIOCERR's digital infrastructure, Blockchain plays an essential role in:</p>

     <ul>
       <li>Ensuring the authenticity of production and logistics records.</li>
       <li>Protecting the intellectual property of innovation.</li>
       <li>Enabling real-time auditing of decentralized industrial processes.</li>
       <li>Integrating smart contracts that automate operating rules between the Parent Company and the MCEFPs.</li>
     </ul>

     <p>Thus, Blockchain is not only a security technology, but also a pillar of digital governance, ensuring the integrity of the production network and trust among all stakeholders.</p>

      <div class="graph-wrapper" aria-label="BIOBlock chain">
        <div id="networkBlockchain"></div>
        <div class="graph-instructions">
          üí° <strong>How to interact with the graph:</strong><br>
          ‚Ä¢ Use mouse wheel (or pinch) to zoom.<br>
          ‚Ä¢ Click nodes to view content.<br>
          ‚Ä¢ Drag the background to move the view.<br>
          ‚Ä¢ Drag nodes to reposition them; arrows follow.<br>
          ‚Ä¢ Double-click any empty area to re-center.
        </div>

        <div id="nodeDetailsBlockchain" role="region" aria-live="polite"></div>
      </div>

      <div style="text-align:center; margin: 20px 0;">
        <a href="Blockchain_Panel_GAIA.html" style="padding:12px 25px; font-size:1.1em; border-radius:25px; text-decoration:none; color:white; background:#74f2ce; display:inline-block; transition:0.3s;">
          Open Blockchain Panel
        </a>
      </div>
    </div>

    <div class="tech-card" onclick="toggleBox('bigdata')">üìä Big Data</div>
    <div id="bigdata" class="box-hidden">
      <p><strong>Live Stream:</strong> The term Big Data refers to the massive set of data continuously generated by people, companies, devices and digital systems. This data is characterized by the so-called ‚Äú5 Vs‚Äù:</p>

      <ul>
        <li>Volume: The amount of data grows exponentially, requiring new forms of storage.</li>
        <li>Velocity: Capture and processing must occur in real time or near real time.</li>
        <li>Variety: Data can be structured (spreadsheets, relational databases) or unstructured (images, videos, texts, IoT sensors).</li>
        <li>Veracity: The quality and reliability of the information must be validated.</li>
        <li>Value: Transforming data into strategic knowledge is the ultimate goal.</li>
      </ul>

      <p>In the context of Digital Infrastructure, Big Data is essential for analyzing consumption patterns, predicting system failures, monitoring production chains, and supporting evidence-based strategic decisions.</p>

      <p>The most widely used technologies include:</p>

      <ul>
        <li>Hadoop and Spark for massive processing Distributed.</li>
        <li>Data Lakes for storing raw data on a large scale.</li>
        <li>Machine Learning applied to predict trends, detect anomalies, and optimize processes.</li>
     </ul>

      <p>In the case of BIOCERR and SMPD, Big Data is essential for integrating information from MCEFPs, the parent company, and end users, enabling real-time monitoring and generating insights that strengthen the system's sustainability and efficiency. BIOCERR's Big Data module transforms massive volumes of information into regenerative intelligence. It collects, organizes, and interprets data from various sources‚Äîfrom sensors in MCEFPs to public systems, climate databases, community indicators, and real-time interactions with users.</p>

      <div class="graph-wrapper" aria-label="Big Data pipeline">
        <div id="networkBigData"></div>
        <div class="graph-instructions">
          üí° <strong>How to interact with the graph:</strong><br>
          ‚Ä¢ Use mouse wheel (or pinch) to zoom.<br>
          ‚Ä¢ Click nodes to view content.<br>
          ‚Ä¢ Drag the background to move the view.<br>
          ‚Ä¢ Drag nodes to reposition them; arrows follow.<br>
          ‚Ä¢ Double-click any empty area to re-center.
        </div>

        <div id="nodeDetailsBigData" role="region" aria-live="polite"></div>
      </div>

      <div style="text-align:center; margin: 20px 0;">
        <a href="BigData_Panel_GAIA.html" style="padding:12px 25px; font-size:1.1em; border-radius:25px; text-decoration:none; color:white; background:#74f2ce; display:inline-block; transition:0.3s;">
          Open Big Data Panel
        </a>
      </div>
    </div>

    <div class="tech-card" onclick="toggleBox('iot')">üåê IoT</div>
    <div id="iot" class="box-hidden">
      <p><strong>BIO-IoT Network:</strong> At BIOCERR, the Internet of Things (IoT) is much more than connecting objects‚Äîit's a way to enhance the sensitivity of the territory. Each MCEFP functions as a living organism, equipped with sensors and devices that monitor variables in real time: temperature, bottling flow, water usage, reservoir levels, air quality, energy consumption, and even human interaction patterns.</p>

      <p>The Internet of Things (IoT) represents the integration of physical devices into the digital environment, allowing sensors, machines, vehicles, and industrial systems to connect and exchange information in real time. This infrastructure expands operational intelligence, reduces human error, and enables automated decisions based on continuously collected data.</p>

      <p>In the context of Industry 4.0, the IoT is essential for monitoring production chains, tracking assets, and efficiently managing energy resources. Each connected device acts as a smart node, sending data to analytical platforms that identify patterns, anomalies, and optimization opportunities.</p>

      <p>Among its applications are:</p>

      <ul>
        <li>Smart Manufacturing: connected machines that autonomously adjust production parameters.</li>
        <li>Smart Cities: urban sensors that monitor traffic, street lighting, and air quality.</li>
        <li>Connected Health: wearable devices that collect vital information and integrate preventative diagnostics.</li>
        <li>Logistics: real-time cargo and fleet tracking, reducing losses and increasing predictability.</li>
     </ul>

      <p>Along with Blockchain and Big Data, IoT forms the technological tripod of digital transformation, enabling decentralized, transparent, and highly scalable operations.</p>

      <div class="graph-wrapper" aria-label="IoT topology">
        <div id="networkIoT"></div>
        <div class="graph-instructions">
          üí° <strong>How to interact with the graph:</strong><br>
          ‚Ä¢ Use mouse wheel (or pinch) to zoom.<br>
          ‚Ä¢ Click nodes to view content.<br>
          ‚Ä¢ Drag the background to move the view.<br>
          ‚Ä¢ Drag nodes to reposition them; arrows follow.<br>
          ‚Ä¢ Double-click any empty area to re-center.
        </div>

        <div id="nodeDetailsIoT" role="region" aria-live="polite"></div>
      </div>

      <div style="text-align:center; margin: 20px 0;">
        <a href="IoT_Panel_GAIA.html" style="padding:12px 25px; font-size:1.1em; border-radius:25px; text-decoration:none; color:white; background:#74f2ce; display:inline-block; transition:0.3s;">
          Open IoT Panel
        </a>
      </div>
    </div>

    <div class="tech-card" onclick="toggleBox('gemeos')">üßø Digital Twins</div>
    <div id="gemeos" class="box-hidden">
      <p><strong>Regenerative Simulators:</strong> At BIOCERR, Digital Twins are not just virtual copies of equipment or processes‚Äîthey are living mirrors of regenerative territories. Each MCEFP and Parent Plant can have its own digital version that simulates, anticipates, and learns from the real behavior of physical systems.</p>

      <p>This means we can predict failures, optimize routes, adapt production, and even test complex decisions without causing real impact. It's as if the factory itself could dream before acting.</p>

      <p>BIOCERR's Digital Twins also integrate environmental, social, and operational data in real time. This allows us to understand how local decisions affect the environment, biodiversity, logistics flows, and the well-being of communities.</p>

      <p>More than automation, Digital Twins enable anticipatory governance‚Äîdecisions based on simulations, with human participation and artificial intelligence working together for the collective good.</p>

      <p>In the BIOCERR vision, a Digital Twin is a sensitive and projective memory of the relationship between technology, nature, and care.</p>

      <div class="graph-wrapper" aria-label="Digital Twins interactive graph">
        <div id="network"></div>
        <div id="graphInstructions" class="graph-instructions">
          üí° <strong>How to interact with the graph:</strong><br>
          ‚Ä¢ Use mouse wheel (or pinch) to zoom.<br>
          ‚Ä¢ Click nodes to view details.<br>
          ‚Ä¢ Drag the background to move the view.<br>
          ‚Ä¢ Drag nodes to reposition them; arrows follow.<br>
          ‚Ä¢ Double-click any empty area to re-center.
        </div>

        <div id="nodeDetails" role="region" aria-live="polite"></div>
      </div>

      <div style="text-align:center; margin: 20px 0;">
        <a href="Digital_Twins_BIOCERR.html" style="padding:12px 25px; font-size:1.1em; border-radius:25px; text-decoration:none; color:white; background:#74f2ce; display:inline-block; transition:0.3s;">
          Open Digital Twins
        </a>
      </div>
    </div>

    <div class="tech-card" onclick="toggleBox('ciber')">üõ°Ô∏è Cybersecurity</div>
    <div id="ciber" class="box-hidden">
      <p><strong>BIO Shield ‚Äì GAIA Cloud & Operations:</strong> Cybersecurity at BIOCERR is a living, distributed, auditable layer protecting people, data and processes across the MDPS: Central Industry, MEFFPs, digital twins and the GAIA cloud. We apply layered defense (Zero Trust), strong identity, end-to-end encryption, microsegmentation, continuous AI monitoring by BIO and incident response routines with immutable audit trails.</p>

      <ul>
        <li><strong>Identity & Access:</strong> MFA, per-unit certificates (BIO PKI), role-based access control and rotating service keys.</li>
        <li><strong>Perimeter & Transit:</strong> NGFWs, VPN (WireGuard/OpenVPN), TLS 1.3 and least-privilege policies between services.</li>
        <li><strong>GAIA Cloud:</strong> encryption at rest (KMS), orchestrated policies, namespace isolation, image scanning and drift detection.</li>
        <li><strong>Monitoring & SIEM:</strong> log collectors, event correlation (Wazuh/ELK), real-time alerts and response playbooks (TheHive/Cortex).</li>
        <li><strong>Backup & Resilience:</strong> geo-replication, restoration tests, immutable logs (WORM) and blockchain-based incident recording.</li>
        <li><strong>Compliance & Ethics:</strong> ISO 27001 / NIST guidelines, privacy by design and governance trails with BIO Council participation.</li>
      </ul>

      <div class="graph-wrapper" aria-label="GAIA security map">
        <div id="networkGaia"></div>
        <div id="graphInstructionsGaia" class="graph-instructions">
          üí° <strong>How to interact with the graph:</strong><br>
          ‚Ä¢ Use mouse wheel (or pinch) to zoom.<br>
          ‚Ä¢ Click nodes to view details.<br>
          ‚Ä¢ Drag the background to move the view.<br>
          ‚Ä¢ Drag nodes to reposition them; arrows follow.<br>
          ‚Ä¢ Double-click any empty area to re-center.
        </div>

        <div id="nodeDetailsGaia" role="region" aria-live="polite"></div>
      </div>

      <div style="text-align:center; margin: 20px 0;">
        <a href="Security_GAIA_Panel.html" style="padding:12px 25px; font-size:1.1em; border-radius:25px; text-decoration:none; color:white; background:#74f2ce; display:inline-block; transition:0.3s;">
          Open GAIA Security Panel
        </a>
      </div>
    </div>

  </div>

  <div class="mist"></div>

  <!-- ===== Scripts ===== -->
  <script>
    /* Toggle and fit control for all modules */
    const fitFlags = { gemeos: false, ciber: false, blockchain: false, bigdata: false, iot: false };

    function toggleBox(id) {
      const box = document.getElementById(id);
      if (!box) return;
      box.style.display = box.style.display === "block" ? "none" : "block";

      setTimeout(() => {
        const map = {
          gemeos: window.network,
          ciber: window.networkGaia,
          blockchain: window.networkBlockchain,
          bigdata: window.networkBigData,
          iot: window.networkIoT
        };
        const net = map[id];
        if (net) {
          try { net.redraw(); } catch (e) { /* ignore */ }
          if (!fitFlags[id]) {
            try { net.fit({ animation: { duration: 600, easing: 'easeInOutQuad' } }); } catch (e) { /* ignore */ }
            fitFlags[id] = true;
          }
        }
      }, 260);
    }

    document.addEventListener("visibilitychange", function() {
      if (!document.hidden) {
        if (window.network) try { window.network.redraw(); } catch (e) {}
        if (window.networkGaia) try { window.networkGaia.redraw(); } catch (e) {}
        if (window.networkBlockchain) try { window.networkBlockchain.redraw(); } catch (e) {}
        if (window.networkBigData) try { window.networkBigData.redraw(); } catch (e) {}
        if (window.networkIoT) try { window.networkIoT.redraw(); } catch (e) {}
      }
    });
  </script>

  <script>
    /* --- Digital Twins (IIFE) --- */
    (function initTwins(){
      const nodes = new vis.DataSet([
        { id: 1, label: "BIO Cloud", shape: "box", color: { background: '#083e36', border: '#74f2ce' }, font: { color: 'white' } },
        { id: 2, label: "Central Industry", shape: "box", color: { background: '#063a6b', border: '#74f2ce' }, font: { color: 'white' } },
        { id: 3, label: "MCFFPs", shape: "box", color: { background: '#4f2b63', border: '#74f2ce' }, font: { color: 'white' } },
        { id: 4, label: "Operators", shape: "ellipse", color: { background: '#b36100', border: '#ffd9b3' }, font: { color: 'white' } },
        { id: 5, label: "End Market", shape: "ellipse", color: { background: '#8b053a', border: '#ffb3c9' }, font: { color: 'white' } },
        { id: 6, label: "BIO Governance", shape: "box", color: { background: '#2b3a3f', border: '#9fbdb6' }, font: { color: 'white' } },
        { id: 7, label: "AI BIO", shape: "box", color: { background: '#145a2f', border: '#74f2ce' }, font: { color: 'white' } }
      ]);

      const edges = new vis.DataSet([
        { from: 1, to: 2, arrows: "to", color: { color: '#74f2ce' } },
        { from: 1, to: 6, arrows: "to", color: { color: '#74f2ce' } },
        { from: 6, to: 7, arrows: "to", color: { color: '#74f2ce' } },
        { from: 2, to: 3, arrows: "to", color: { color: '#74f2ce' } },
        { from: 3, to: 4, arrows: "to", color: { color: '#ffd28f' } },
        { from: 4, to: 5, arrows: "to", color: { color: '#ff9fb3' } },
        { from: 7, to: 3, arrows: "to", color: { color: '#74f2ce' } },
        { from: 7, to: 2, arrows: "to", color: { color: '#74f2ce' } }
      ]);

      const options = {
        physics: {
          enabled: true,
          barnesHut: {
            gravitationalConstant: -8000,
            centralGravity: 0.2,
            springLength: 200,
            springConstant: 0.04
          },
          stabilization: { enabled: true, iterations: 200 }
        },
        interaction: { hover: true, dragNodes: true, zoomView: true, tooltipDelay: 100 },
        nodes: { borderWidth: 2, shadow: true, font: { size: 14 } },
        edges: { arrows: { to: { enabled: true, scaleFactor: 1.2 } }, smooth: { enabled: true, type: 'dynamic' } },
        layout: { improvedLayout: true }
      };

      const container = document.getElementById('network');
      const data = { nodes: nodes, edges: edges };
      const network = new vis.Network(container, data, options);
      window.network = network;

      network.on('doubleClick', function () {
        network.fit({ animation: { duration: 400, easing: 'easeInOutQuad' } });
      });

      const details = {
        1: { title: "BIO Cloud", text: "Coordination & services layer: MQTT brokers, time-series storage, APIs and twin orchestration. Hosts models, dashboards and external integrations." },
        2: { title: "Central Industry", text: "Produces base concentrates in returnable IBCs, manages QC, shipping and integration with ERP/MES. Primary source of traceability data." },
        3: { title: "MCFFPs", text: "Mini Central of Filling and Finisher of Products: local units that personalize batches, run sensors and replicate the MDPS production DNA in the territory." },
        4: { title: "Operators", text: "Local users interacting with simple UIs: batch execution, QC checks, local maintenance and communication with BIO (dashboard or app)." },
        5: { title: "End Market", text: "Points of sale, hospitals and consumers receiving personalized products; they provide demand feedback that feeds the twin." },
        6: { title: "BIO Governance", text: "Council validating policies, ethical limits and approving strategic changes. Operates in a Human-In-The-Loop flow for critical decisions." },
        7: { title: "AI BIO", text: "Intelligence module processing data, producing predictions (maintenance, demand), simulating scenarios and suggesting operational & socio-environmental optimizations." }
      };

      function showNodeDetails(id) {
        const panel = document.getElementById('nodeDetails');
        const d = details[id];
        if (!d) return;
        panel.innerHTML = `
          <h3>${d.title}</h3>
          <p>${d.text}</p>
          <button class="close-btn" onclick="closeDetails()">Close</button>
        `;
        panel.style.display = 'block';
        panel.scrollIntoView({behavior: "smooth", block: "center"});
      }

      window.closeDetails = function(){
        const panel = document.getElementById('nodeDetails');
        panel.style.display = 'none';
        panel.innerHTML = '';
      };

      network.on("click", function (params) {
        if (params.nodes.length > 0) showNodeDetails(params.nodes[0]);
      });
    })();
  </script>

  <script>
    /* --- GAIA Security (IIFE) --- */
    (function initGaia(){
      const gaiaNodes = new vis.DataSet([
        { id: 'gaia', label: 'GAIA Cloud', shape: 'box', color: { background: '#0b2e2a', border: '#74f2ce' }, font: { color: 'white' } },
        { id: 'idm', label: 'Identity & Access', shape: 'ellipse', color: { background: '#254b6e', border: '#9fd8ff' }, font: { color: 'white' } },
        { id: 'edge', label: 'MCFFPs (Edge)', shape: 'box', color: { background: '#4f2b63', border: '#d8a8ff' }, font: { color: 'white' } },
        { id: 'plant', label: 'Central Industry', shape: 'box', color: { background: '#063a6b', border: '#74f2ce' }, font: { color: 'white' } },
        { id: 'perimeter', label: 'Perimeter / VPN / NGFW', shape: 'box', color: { background: '#1d3b2d', border: '#74f2ce' }, font: { color: 'white' } },
        { id: 'crypto', label: 'Encryption (TLS 1.3 / KMS)', shape: 'box', color: { background: '#123b34', border: '#74f2ce' }, font: { color: 'white' } },
        { id: 'siem', label: 'Monitoring & SIEM', shape: 'box', color: { background: '#2b3a3f', border: '#9fbdb6' }, font: { color: 'white' } },
        { id: 'bio', label: 'BIO ‚Äì Adaptive Defense', shape: 'box', color: { background: '#145a2f', border: '#74f2ce' }, font: { color: 'white' } },
        { id: 'backup', label: 'Backup & DR', shape: 'box', color: { background: '#4a3b1a', border: '#ffd28f' }, font: { color: 'white' } },
        { id: 'gov', label: 'Governance & Compliance', shape: 'ellipse', color: { background: '#2b3a3f', border: '#9fbdb6' }, font: { color: 'white' } },
        { id: 'partners', label: 'Partners / APIs', shape: 'ellipse', color: { background: '#5b1f2e', border: '#ffb3c9' }, font: { color: 'white' } }
      ]);

      const gaiaEdges = new vis.DataSet([
        { from: 'idm', to: 'perimeter', arrows: 'to', color: { color: '#74f2ce' } },
        { from: 'perimeter', to: 'gaia', arrows: 'to', color: { color: '#74f2ce' } },
        { from: 'edge', to: 'perimeter', arrows: 'to', color: { color: '#74f2ce' } },
        { from: 'plant', to: 'perimeter', arrows: 'to', color: { color: '#74f2ce' } },
        { from: 'gaia', to: 'crypto', arrows: 'to', color: { color: '#74f2ce' } },
        { from: 'gaia', to: 'siem', arrows: 'to', color: { color: '#74f2ce' } },
        { from: 'siem', to: 'bio', arrows: 'to', color: { color: '#74f2ce' } },
        { from: 'bio', to: 'gaia', arrows: 'to', color: { color: '#74f2ce' } },
        { from: 'gaia', to: 'backup', arrows: 'to', color: { color: '#ffd28f' } },
        { from: 'gov', to: 'gaia', arrows: 'to', color: { color: '#9fbdb6' } },
        { from: 'gaia', to: 'partners', arrows: 'to', color: { color: '#ffb3c9' } }
      ]);

      const gaiaOptions = {
        physics: {
          enabled: true,
          barnesHut: {
            gravitationalConstant: -7000,
            centralGravity: 0.25,
            springLength: 200,
            springConstant: 0.05
          },
          stabilization: { enabled: true, iterations: 250 }
        },
        interaction: { hover: true, dragNodes: true, zoomView: true, tooltipDelay: 100 },
        nodes: { borderWidth: 2, shadow: true, font: { size: 14 } },
        edges: { arrows: { to: { enabled: true, scaleFactor: 1.2 } }, smooth: { enabled: true, type: 'dynamic' } },
        layout: { improvedLayout: true }
      };

      const gaiaContainer = document.getElementById('networkGaia');
      const gaiaData = { nodes: gaiaNodes, edges: gaiaEdges };
      const networkGaia = new vis.Network(gaiaContainer, gaiaData, gaiaOptions);
      window.networkGaia = networkGaia;

      networkGaia.on('doubleClick', function () {
        networkGaia.fit({ animation: { duration: 400, easing: 'easeInOutQuad' } });
      });

      const gaiaDetails = {
        'idm': { title: 'Identity & Access', text: 'MFA (app/token), per-unit certificates (BIO PKI), role-based access control and segregated service accounts with key rotation.' },
        'perimeter': { title: 'Perimeter / VPN / NGFW', text: 'Mandatory VPN (WireGuard/OpenVPN), NGFWs, DDoS protection and L7 filtering for APIs and panels.' },
        'gaia': { title: 'GAIA Cloud', text: 'Control plane and data: orchestration, pipelines, storages and services. Security policies per project/namespace.' },
        'crypto': { title: 'Encryption (TLS 1.3 / KMS)', text: 'Encryption in transit (TLS 1.3) and at rest with central key management (KMS). Secrets stored in secure vaults.' },
        'siem': { title: 'Monitoring & SIEM', text: 'Log collection and correlation (Wazuh/ELK), anomaly detection, real-time dashboard and actionable alerts.' },
        'bio': { title: 'BIO ‚Äì Adaptive Defense', text: 'Defensive AI that learns from incidents, recommends/executes playbooks, contains attacks and suggests hardening.' },
        'backup': { title: 'Backup & DR', text: 'Geo-replication, regular restore tests, WORM/immutable logs and a validated disaster plan.' },
        'edge': { title: 'MCFFPs (Edge)', text: 'Hardened edge nodes, signed updates, secure telemetry and offline-tolerant operation.' },
        'plant': { title: 'Central Industry', text: 'Central production environment with microsegmentation, change control and secure integration with ERP/MES.' },
        'partners': { title: 'Partners / APIs', text: 'External integrations with scoped API keys, rate limits and continuous auditing.' }
      };

      function showGaiaDetails(id) {
        const panel = document.getElementById('nodeDetailsGaia');
        const d = gaiaDetails[id];
        if (!d) return;
        panel.innerHTML = `
          <h3>${d.title}</h3>
          <p>${d.text}</p>
          <button class="close-btn" onclick="closeGaiaDetails()">Close</button>
        `;
        panel.style.display = 'block';
        panel.scrollIntoView({behavior: 'smooth', block: 'center'});
      }

      window.closeGaiaDetails = function(){
        const panel = document.getElementById('nodeDetailsGaia');
        panel.style.display = 'none';
        panel.innerHTML = '';
      };

      networkGaia.on('click', function (params) {
        if (params.nodes.length > 0) showGaiaDetails(params.nodes[0]);
      });
    })();
  </script>

  <script>
    /* --- Blockchain / Big Data / IoT (IIFE unified) --- */
    (function initOthers(){
      /* --- Blockchain --- */
      const bcNodes = new vis.DataSet([
        { id: 'g', label: 'Block #0\n(Genesis)', shape: 'box', color: { background: '#0b2e2a', border: '#74f2ce' }, font: { color: 'white' } },
        { id: 'b1', label: 'Block #1', shape: 'box', color: { background: '#10423a', border: '#74f2ce' }, font: { color: 'white' } },
        { id: 'b2', label: 'Block #2', shape: 'box', color: { background: '#145046', border: '#74f2ce' }, font: { color: 'white' } },
        { id: 'b3', label: 'Block #3', shape: 'box', color: { background: '#195d52', border: '#74f2ce' }, font: { color: 'white' } }
      ]);
      const bcEdges = new vis.DataSet([
        { from: 'g', to: 'b1', arrows: 'to', color: { color: '#74f2ce' } },
        { from: 'b1', to: 'b2', arrows: 'to', color: { color: '#74f2ce' } },
        { from: 'b2', to: 'b3', arrows: 'to', color: { color: '#74f2ce' } }
      ]);
      const elBc = document.getElementById('networkBlockchain');
      if(elBc){
        const netBc = new vis.Network(elBc, { nodes: bcNodes, edges: bcEdges }, {
          physics: { enabled: true, barnesHut: { gravitationalConstant: -6500, springLength: 180, springConstant: 0.045 }, stabilization: { iterations: 220 } },
          interaction: { hover: true, dragNodes: true, zoomView: true, tooltipDelay: 100 },
          nodes: { borderWidth: 2, shadow: true, font: { size: 14 } },
          edges: { arrows: { to: { enabled: true, scaleFactor: 1.1 } }, smooth: { type: 'dynamic' } }
        });
        window.networkBlockchain = netBc;

        const metaBc = {
          'g': { title: 'Genesis Block', text: 'Initial chain creation. Defines parameters and trust anchor. Previous hash: n/a.' },
          'b1': { title: 'Block #1 ‚Äì Production', text: 'Record from Central Industry: batch, timestamp, IBC ID, initial QA and digital signature from the plant.' },
          'b2': { title: 'Block #2 ‚Äì MCFFP Filling', text: 'Filling/labeling operation at MCFFP-07: process parameters, responsible operator, aggregated IoT readings and local QA.' },
          'b3': { title: 'Block #3 ‚Äì Logistics/Returns', text: 'Logistics movement and reverse logistics. Integrity checks, cold chain (if applicable) and destination acceptance.' }
        };

        function showBc(id){
          const p = document.getElementById('nodeDetailsBlockchain');
          if(!p || !metaBc[id]) return;
          p.innerHTML = `<h3>${metaBc[id].title}</h3><p>${metaBc[id].text}</p><button class="close-btn" onclick="this.parentElement.style.display='none'">Close</button>`;
          p.style.display = 'block'; p.scrollIntoView({behavior:'smooth',block:'center'});
        }
        netBc.on('click',(ev)=>{ if(ev.nodes.length) showBc(ev.nodes[0]); });
        netBc.on('doubleClick', ()=> netBc.fit({ animation:{duration:400,easing:'easeInOutQuad'} }));
      }

      /* --- Big Data --- */
      const bdNodes = new vis.DataSet([
        { id: 'coleta', label: 'Ingestion\n(MCFFP/IoT/Blockchain)', shape: 'box', color: { background: '#063a6b', border: '#74f2ce' }, font: { color: 'white' } },
        { id: 'lake', label: 'Data Lake', shape: 'box', color: { background: '#2b3a3f', border: '#9fbdb6' }, font: { color: 'white' } },
        { id: 'process', label: 'Processing\n(Stream/Batch/ML)', shape: 'box', color: { background: '#145a2f', border: '#74f2ce' }, font: { color: 'white' } },
        { id: 'gaiaout', label: 'GAIA Dashboards', shape: 'ellipse', color: { background: '#b36100', border: '#ffd9b3' }, font: { color: 'white' } }
      ]);
      const bdEdges = new vis.DataSet([
        { from: 'coleta', to: 'lake', arrows: 'to', color: { color: '#74f2ce' } },
        { from: 'lake', to: 'process', arrows: 'to', color: { color: '#74f2ce' } },
        { from: 'process', to: 'gaiaout', arrows: 'to', color: { color: '#ffd28f' } }
      ]);
      const elBd = document.getElementById('networkBigData');
      if(elBd){
        const netBd = new vis.Network(elBd, { nodes: bdNodes, edges: bdEdges }, {
          physics: { enabled: true, barnesHut: { gravitationalConstant: -6500, springLength: 180, springConstant: 0.045 }, stabilization: { iterations: 220 } },
          interaction: { hover: true, dragNodes: true, zoomView: true, tooltipDelay: 100 },
          nodes: { borderWidth: 2, shadow: true, font: { size: 14 } },
          edges: { arrows: { to: { enabled: true, scaleFactor: 1.1 } }, smooth: { type: 'dynamic' } }
        });
        window.networkBigData = netBd;

        const metaBd = {
          'coleta': { title: 'Data Ingestion', text: 'MCFFP sensors, IoT and blockchain records send telemetry, events and batches in real-time via MQTT/Kafka/APIs.' },
          'lake': { title: 'Data Lake', text: 'Raw storage with versioning and catalog. Supports columnar and semi-structured formats.' },
          'process': { title: 'Processing', text: 'Streaming pipelines, batch ETL and ML for forecasts and anomaly detection.' },
          'gaiaout': { title: 'GAIA Dashboards', text: 'Operational & ESG KPIs in real-time, reports and insights for Operations and BIO Governance.' }
        };

        function showBd(id){
          const p = document.getElementById('nodeDetailsBigData');
          if(!p || !metaBd[id]) return;
          p.innerHTML = `<h3>${metaBd[id].title}</h3><p>${metaBd[id].text}</p><button class="close-btn" onclick="this.parentElement.style.display='none'">Close</button>`;
          p.style.display = 'block'; p.scrollIntoView({behavior:'smooth',block:'center'});
        }
        netBd.on('click',(ev)=>{ if(ev.nodes.length) showBd(ev.nodes[0]); });
        netBd.on('doubleClick', ()=> netBd.fit({ animation:{duration:400,easing:'easeInOutQuad'} }));
      }

      /* --- IoT --- */
      const iotNodes = new vis.DataSet([
        { id: 'sensores', label: 'Sensors/Actuators', shape: 'ellipse', color: { background: '#4f2b63', border: '#d8a8ff' }, font: { color: 'white' } },
        { id: 'gateway', label: 'Gateway (MQTT/LoRa/5G)', shape: 'box', color: { background: '#063a6b', border: '#74f2ce' }, font: { color: 'white' } },
        { id: 'edge', label: 'Edge (Pre-processing)', shape: 'box', color: { background: '#2b3a3f', border: '#9fbdb6' }, font: { color: 'white' } },
        { id: 'nuvem', label: 'Cloud / GAIA', shape: 'box', color: { background: '#0b2e2a', border: '#74f2ce' }, font: { color: 'white' } }
      ]);
      const iotEdges = new vis.DataSet([
        { from: 'sensores', to: 'gateway', arrows: 'to', color: { color: '#d8a8ff' } },
        { from: 'gateway', to: 'edge', arrows: 'to', color: { color: '#74f2ce' } },
        { from: 'edge', to: 'nuvem', arrows: 'to', color: { color: '#9fbdb6' } }
      ]);
      const elIot = document.getElementById('networkIoT');
      if(elIot){
        const netIot = new vis.Network(elIot, { nodes: iotNodes, edges: iotEdges }, {
          physics: { enabled: true, barnesHut: { gravitationalConstant: -6500, springLength: 180, springConstant: 0.045 }, stabilization: { iterations: 220 } },
          interaction: { hover: true, dragNodes: true, zoomView: true, tooltipDelay: 100 },
          nodes: { borderWidth: 2, shadow: true, font: { size: 14 } },
          edges: { arrows: { to: { enabled: true, scaleFactor: 1.1 } }, smooth: { type: 'dynamic' } }
        });
        window.networkIoT = netIot;

        const metaIot = {
          'sensores': { title: 'Sensors/Actuators', text: 'Measures level, pressure, temperature, flow, pH and actuates valves/pumps. Core of local automation.' },
          'gateway': { title: 'Gateway', text: 'Aggregates data, translates protocols (MQTT/CoAP), manages connectivity (5G/LoRa/Wi-Fi) and initial security policies.' },
          'edge': { title: 'Edge Computing', text: 'Filters noise, aggregates readings and runs immediate control logic with minimal latency.' },
          'nuvem': { title: 'Cloud/GAIA', text: 'Persistence, analysis, alerts and integration with Big Data and Blockchain for traceability.' }
        };

        function showIot(id){
          const p = document.getElementById('nodeDetailsIoT');
          if(!p || !metaIot[id]) return;
          p.innerHTML = `<h3>${metaIot[id].title}</h3><p>${metaIot[id].text}</p><button class="close-btn" onclick="this.parentElement.style.display='none'">Close</button>`;
          p.style.display = 'block'; p.scrollIntoView({behavior:'smooth',block:'center'});
        }
        netIot.on('click',(ev)=>{ if(ev.nodes.length) showIot(ev.nodes[0]); });
        netIot.on('doubleClick', ()=> netIot.fit({ animation:{duration:400,easing:'easeInOutQuad'} }));
      }

    })();
  </script>

</body>
</html>
